<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="supportMapper">
	<select id="getListCount" resultType="_int">
		SELECT COUNT(*)
		FROM BOARD
		WHERE BOARD_STATUS='Y'
	</select>
	
	<select id="selectList" resultMap="boardResultSet">
		SELECT *
		FROM BOARD 
		WHERE BOARD_STATUS='Y'
		ORDER BY BOARD_NO DESC
	</select>

	<resultMap type="Board" id="boardResultSet">
		<id property="bNo" column="BOARD_NO"/>
		<result property="bTitle" column="BOARD_TITLE"/>
		<result property="bContent" column="BOARD_CONTENT"/>
		<result property="bWriter" column="BOARD_WRITER"/>
		<result property="bView" column="BOARD_VIEW"/>
		<result property="bCreateDate" column="BOARD_CREATE_DATE"/>
		<result property="bModifyDate" column="BOARD_MODIFY_DATE"/>
		<result property="bStatus" column="BOARD_STATUS"/>
		<result property="cateNo" column="CATE_NO"/>
	</resultMap>
	
	<insert id="insertBoard">
		INSERT 
		INTO BOARD 
		VALUES (SEQ_BNO.nextval, #{bTitle}, #{bContent},
					 0, SYSDATE, SYSDATE, 'Y', 1, #{bWriter})
	</insert>
	
	<insert id="insertFile">
		INSERT 
		INTO FILE_INFO 
		VALUES(SEQ_FNO.NEXTVAL, #{fileName}, #{changeName}, SYSDATE, 1, 
					#{filePath}, 'Y', SEQ_BNO.CURRVAL, NULL)
	</insert>
	
	
	<update id="updateView">
		UPDATE BOARD
		SET BOARD_VIEW = BOARD_VIEW + 1
		WHERE BOARD_NO=#{bNo} AND CATE_NO=1	
	</update>
	
	<select id="detailBoard" resultMap="boardResultSet">
		SELECT *
		FROM BOARD 
		WHERE BOARD_STATUS='Y' AND BOARD_NO=#{bNo} AND CATE_NO=1
		ORDER BY BOARD_NO DESC
	</select>
	
	<select id="detailFile" resultMap="fileInfoResultMap">
		SELECT FILE_NO,FILE_NAME,FILE_CHANGE,FILE_CREATE_DATE,FILE_LEVEL,
				FILE_PATH,FILE_STATUS,BOARD_NO
		FROM FILE_INFO
		WHERE BOARD_NO=#{bNo}
	</select>
	
	<resultMap type="FileInfo" id="fileInfoResultMap">
		<id property="fileNo" column="FILE_NO"/>
		<result property="fileName" column="FILE_NAME"/>
		<result property="changeName" column="FILE_CHANGE"/>
		<result property="fileCreateDate" column="FILE_CREATE_DATE"/>
		<result property="fileLevel" column="FILE_LEVEL"/>
		<result property="filePath" column="FILE_PATH"/>
		<result property="fileStatus" column="FILE_STATUS"/>
		<result property="BoardNo" column="BOARD_NO"/>
	</resultMap>
</mapper>
